from __future__ import annotations

from typing import Dict, List
from models import TriageResult, ConditionHypothesis


UI_TEXT: Dict[str, Dict[str, str]] = {
    "title": {
        "ru": "ü©∫ AI Medical Assistant",
        "en": "ü©∫ AI Medical Assistant",
    },
    "disclaimer": {
        "ru": "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ù–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º —Å–æ–≤–µ—Ç–æ–º.",
        "en": "Demo assistant. Not medical advice.",
    },
    "settings": {"ru": "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ò–ò", "en": "AI Settings"},
    "provider": {"ru": "–ü—Ä–æ–≤–∞–π–¥–µ—Ä", "en": "Provider"},
    "openai_model": {"ru": "OpenAI –º–æ–¥–µ–ª—å", "en": "OpenAI model"},
    "ollama_model": {"ru": "Ollama –º–æ–¥–µ–ª—å", "en": "Ollama model"},
    "temperature": {"ru": "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏", "en": "Model temperature"},
    "faq": {"ru": "FAQ", "en": "FAQ"},
    "faq_search": {"ru": "–ü–æ–∏—Å–∫ –ø–æ FAQ", "en": "Search FAQ"},
    "symptoms_input": {"ru": "–í–≤–æ–¥ —Å–∏–º–ø—Ç–æ–º–æ–≤", "en": "Symptoms Input"},
    "age": {"ru": "–í–æ–∑—Ä–∞—Å—Ç", "en": "Age"},
    "sex": {"ru": "–ü–æ–ª", "en": "Sex"},
    "duration": {"ru": "–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–Ω–µ–π)", "en": "Duration (days)"},
    "severity": {"ru": "–¢—è–∂–µ—Å—Ç—å (1-10)", "en": "Severity (1-10)"},
    "notes": {"ru": "–ü—Ä–∏–º–µ—á–∞–Ω–∏—è", "en": "Notes"},
    "symptoms_tags": {
        "ru": "–°–∏–º–ø—Ç–æ–º—ã (–≤–≤–æ–¥–∏—Ç–µ –∏ –Ω–∞–∂–∏–º–∞–π—Ç–µ Enter)",
        "en": "Symptoms (type and press Enter)",
    },
    "symptoms_csv": {"ru": "–°–∏–º–ø—Ç–æ–º—ã —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é", "en": "Symptoms comma-separated"},
    "analyze": {"ru": "üîé –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏–º–ø—Ç–æ–º—ã", "en": "üîé Analyze symptoms"},
    "triage_results": {"ru": "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—Ä–∏–∞–∂–∞", "en": "Triage Results"},
    "risk_level": {"ru": "–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞", "en": "Risk level"},
    "possible_conditions": {"ru": "–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã", "en": "Possible conditions"},
    "self_care": {"ru": "–°–∞–º–æ–ø–æ–º–æ—â—å", "en": "Self-care"},
    "doctor_questions": {"ru": "–í–æ–ø—Ä–æ—Å—ã –≤—Ä–∞—á—É", "en": "Questions for doctor"},
    "ai_recommendations": {"ru": "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ò–ò", "en": "AI Recommendations"},
    "llm_offline": {
        "ru": "LLM –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–Ω–µ—Ç –∫–ª—é—á–∞/OpenAI –∏–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω Ollama). –ü–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—Ä–∏–∞–∂–∞.",
        "en": "LLM is not configured (no OpenAI key or Ollama not running). Showing triage only.",
    },
    "future": {"ru": "–ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ", "en": "Future plans"},
    "future_items": {
        "ru": "- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–¥–∞–≤–ª–µ–Ω–∏—è/–ø—É–ª—å—Å–∞ (–ª–∏–Ω–µ–π–Ω—ã–µ –∏ —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏)\n- –ò—Å—Ç–æ—Ä–∏—è –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ PDF",
        "en": "- Visualization of temperature/blood pressure/pulse (line and bar charts)\n- Patient history and PDF export",
    },
    "language": {"ru": "–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞", "en": "Interface language"},
    "language_help": {"ru": "–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è", "en": "Select application language"},
    "settings_help": {"ru": "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ –ò–ò", "en": "Parameters for AI response generation"},
    "provider_help": {"ru": "–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –ò–ò: OpenAI (–æ–±–ª–∞–∫–æ) –∏–ª–∏ Ollama (–ª–æ–∫–∞–ª—å–Ω–æ)", "en": "Select AI provider: OpenAI (cloud) or Ollama (local)"},
    "openai_model_help": {"ru": "–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ OpenAI (–Ω–∞–ø—Ä. gpt-4o-mini)", "en": "OpenAI model name (e.g., gpt-4o-mini)"},
    "ollama_model_help": {"ru": "–ù–∞–∑–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ Ollama (–Ω–∞–ø—Ä. llama3:8b-instruct)", "en": "Ollama local model name (e.g., llama3:8b-instruct)"},
    "temperature_help": {"ru": "–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏: –≤—ã—à–µ ‚Äî –±–æ–ª–µ–µ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã", "en": "Model creativity: higher = more diverse answers"},
    "faq_desc": {"ru": "–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –∏ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞–º", "en": "Frequently asked questions on diseases and medicines"},
    "faq_search_help": {"ru": "–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ FAQ", "en": "Enter a query to search the FAQ"},
    "symptoms_desc": {"ru": "–û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ —Å–∏–º–ø—Ç–æ–º—ã ‚Äî –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ü–µ–Ω–∏—Ç —Ä–∏—Å–∫–∏ –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã", "en": "Describe your symptoms ‚Äî the assistant will assess risks and possible causes"},
    "symptoms_help": {"ru": "–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã –ø–æ –æ–¥–Ω–æ–º—É (–∏–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)", "en": "List symptoms one by one (or comma-separated)"},
    "age_help": {"ru": "–í–æ–∑—Ä–∞—Å—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤ –≥–æ–¥–∞—Ö", "en": "Patient age in years"},
    "sex_help": {"ru": "–ü–æ–ª –ø–∞—Ü–∏–µ–Ω—Ç–∞", "en": "Patient biological sex"},
    "duration_help": {"ru": "–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è —Å–∏–º–ø—Ç–æ–º—ã", "en": "How many days symptoms have persisted"},
    "severity_help": {"ru": "–°—É–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è —Ç—è–∂–µ—Å—Ç—å —Å–∏–º–ø—Ç–æ–º–æ–≤ (1 ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ, 10 ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ)", "en": "Subjective symptom severity (1 minimal, 10 maximal)"},
    "notes_help": {"ru": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è: –ø—Ä–∏—ë–º –ª–µ–∫–∞—Ä—Å—Ç–≤, —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ –±–æ–ª–µ–∑–Ω–∏ –∏ —Ç. –¥.", "en": "Additional info: medications, comorbidities, etc."},
    "analyze_help": {"ru": "–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏", "en": "Run analysis and generate recommendations"},
    "triage_desc": {"ru": "–≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–∏–∞–∂: –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º", "en": "Heuristic triage: preliminary rule-based assessment"},
    "ai_reco_desc": {"ru": "–ü–æ—è—Å–Ω–µ–Ω–∏—è –∏ —Å–æ–≤–µ—Ç—ã, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª—å—é", "en": "Explanations and advice generated by the language model"},
}

# Placeholders
UI_TEXT.update({
    "faq_placeholder": {
        "ru": "–ù–∞–ø—Ä–∏–º–µ—Ä: –≥—Ä–∏–ø–ø, –∫–∞—à–µ–ª—å, –ø–∞—Ä–∞—Ü–µ—Ç–∞–º–æ–ª",
        "en": "E.g.: flu, cough, paracetamol",
    },
    "symptoms_placeholder": {
        "ru": "–ù–∞–ø—Ä–∏–º–µ—Ä: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –∫–∞—à–µ–ª—å",
        "en": "E.g.: fever, cough",
    },
    "notes_placeholder": {
        "ru": "–ù–∞–ø—Ä–∏–º–µ—Ä: –ø—Ä–∏–Ω–∏–º–∞—é –ø–∞—Ä–∞—Ü–µ—Ç–∞–º–æ–ª, –∞–ª–ª–µ—Ä–≥–∏—è –Ω–∞ –ø–µ–Ω–∏—Ü–∏–ª–ª–∏–Ω",
        "en": "E.g.: taking paracetamol, penicillin allergy",
    },
    "openai_model_ph": {
        "ru": "–Ω–∞–ø—Ä–∏–º–µ—Ä: gpt-4o-mini",
        "en": "e.g.: gpt-4o-mini",
    },
    "ollama_model_ph": {
        "ru": "–Ω–∞–ø—Ä–∏–º–µ—Ä: llama3:8b-instruct",
        "en": "e.g.: llama3:8b-instruct",
    },
})


SYMPTOM_SUGGESTIONS = {
    "ru": [
        "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞",
        "–∫–∞—à–µ–ª—å",
        "–≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å",
        "–±–æ–ª—å –≤ –≥–æ—Ä–ª–µ",
        "–æ–¥—ã—à–∫–∞",
        "–±–æ–ª—å –≤ –≥—Ä—É–¥–∏",
        "–±–æ–ª—å –≤ –∂–∏–≤–æ—Ç–µ",
        "—Å—ã–ø—å",
        "–¥–∏–∞—Ä–µ—è",
        "—Ç–æ—à–Ω–æ—Ç–∞",
    ],
    "en": [
        "fever",
        "cough",
        "headache",
        "sore throat",
        "shortness of breath",
        "chest pain",
        "abdominal pain",
        "rash",
        "diarrhea",
        "nausea",
    ],
}


RISK_MAP = {
    "ru": {
        "low": "–Ω–∏–∑–∫–∏–π",
        "moderate": "—É–º–µ—Ä–µ–Ω–Ω—ã–π",
        "high": "–≤—ã—Å–æ–∫–∏–π",
        "emergency": "—ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π",
    },
    "en": {
        "low": "low",
        "moderate": "moderate",
        "high": "high",
        "emergency": "emergency",
    },
}


CONDITION_RU_EN = {
    "–í–∏—Ä—É—Å–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è": "Viral infection",
    "–ë–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–µ–∫—Ü–∏—è": "Bacterial infection",
    "–ì—Ä–∏–ø–ø": "Influenza (flu)",
    "COVID-19": "COVID-19",
    "–ü—Ä–æ—Å—Ç—É–¥–∞": "Common cold",
    "–ü–Ω–µ–≤–º–æ–Ω–∏—è": "Pneumonia",
    "–ë—Ä–æ–Ω—Ö–∏—Ç": "Bronchitis",
    "–§–∞—Ä–∏–Ω–≥–∏—Ç": "Pharyngitis",
    "–ê–Ω–≥–∏–Ω–∞ (—Å—Ç—Ä–µ–ø—Ç–æ–∫–æ–∫–∫)": "Strep throat (tonsillitis)",
    "–û–†–í–ò": "ARI (acute respiratory infection)",
    "–ú–∏–≥—Ä–µ–Ω—å": "Migraine",
    "–ù–∞–ø—Ä—è–∂—ë–Ω–Ω–∞—è –≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å": "Tension headache",
    "–°–∏–Ω—É—Å–∏—Ç": "Sinusitis",
    "–°—Ç–µ–Ω–æ–∫–∞—Ä–¥–∏—è": "Angina",
    "–ò–Ω—Ñ–∞—Ä–∫—Ç –º–∏–æ–∫–∞—Ä–¥–∞": "Myocardial infarction",
    "–ú—ã—à–µ—á–Ω–æ-—Å–∫–µ–ª–µ—Ç–Ω–∞—è –±–æ–ª—å": "Musculoskeletal pain",
    "–¢—Ä–µ–≤–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ": "Anxiety disorder",
    "–ê—Å—Ç–º–∞": "Asthma",
    "–¢–≠–õ–ê": "Pulmonary embolism",
    "–°–µ—Ä–¥–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å": "Heart failure",
    "–ì–∞—Å—Ç—Ä–æ—ç–Ω—Ç–µ—Ä–∏—Ç": "Gastroenteritis",
    "–ê–ø–ø–µ–Ω–¥–∏—Ü–∏—Ç": "Appendicitis",
    "–ñ–ö–ë/–∫–æ–ª–∏–∫–∞": "Biliary colic (gallstones)",
    "–ê–ª–ª–µ—Ä–≥–∏—á–µ—Å–∫–∏–π –¥–µ—Ä–º–∞—Ç–∏—Ç": "Allergic dermatitis",
    "–í–∏—Ä—É—Å–Ω–∞—è —ç–∫–∑–∞–Ω—Ç–µ–º–∞": "Viral exanthem",
    "–ü–∏—â–µ–≤–∞—è —Ç–æ–∫—Å–∏–∫–æ–∏–Ω—Ñ–µ–∫—Ü–∏—è": "Foodborne illness",
    "–°–∏–Ω–¥—Ä–æ–º —Ä–∞–∑–¥—Ä–∞–∂—ë–Ω–Ω–æ–≥–æ –∫–∏—à–µ—á–Ω–∏–∫–∞": "Irritable bowel syndrome",
    "–ì–∞—Å—Ç—Ä–∏—Ç": "Gastritis",
    "–ë–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å": "Pregnancy",
    "–ù–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã": "Nonspecific symptoms",
}


PHRASE_RU_EN = {
    # Advice
    "–ü–µ–π—Ç–µ –±–æ–ª—å—à–µ –∂–∏–¥–∫–æ—Å—Ç–∏": "Drink more fluids",
    "–ñ–∞—Ä–æ–ø–æ–Ω–∏–∂–∞—é—â–µ–µ (–ø–∞—Ä–∞—Ü–µ—Ç–∞–º–æ–ª/–∏–±—É–ø—Ä–æ—Ñ–µ–Ω) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏": "Antipyretics (paracetamol/ibuprofen) if needed",
    "–û—Ç–¥—ã—Ö –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã": "Rest and monitor temperature",
    "–¢—ë–ø–ª–æ–µ –ø–∏—Ç—å—ë": "Warm drinks",
    "–ü–æ–∫–æ–π": "Rest",
    "–ü—Ä–∏ –≤–ª–∞–∂–Ω–æ–º –∫–∞—à–ª–µ ‚Äî –º—É–∫–æ–ª–∏—Ç–∏–∫–∏ –ø–æ –ø–æ–∫–∞–∑–∞–Ω–∏—è–º": "If productive cough ‚Äî mucolytics as indicated",
    "–ü–æ–ª–æ—Å–∫–∞–Ω–∏—è": "Gargling",
    "–¢–æ–ø–∏—á–µ—Å–∫–∏–µ –∞–Ω—Ç–∏—Å–µ–ø—Ç–∏–∫–∏": "Topical antiseptics",
    "–ì–∏–¥—Ä–∞—Ç–∞—Ü–∏—è": "Hydration",
    "–ù–ü–í–° –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏": "NSAIDs if needed",
    "–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–∏—Å–∫–∏": "Immediate risk assessment",
    "–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É": "Reduce physical activity",
    "–°—Ä–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è": "Urgent evaluation",
    "–î—Ä–æ–±–Ω–æ–µ –ø–∏—Ç—å—ë": "Small frequent sips",
    "–õ—ë–≥–∫–∞—è –¥–∏–µ—Ç–∞": "Light diet",
    "–ò–∑–±–µ–≥–∞—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª–µ–π": "Avoid irritants",
    "–ê–Ω—Ç–∏–≥–∏—Å—Ç–∞–º–∏–Ω–Ω—ã–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏": "Antihistamines if needed",
    "–û—Ä–∞–ª—å–Ω–∞—è —Ä–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è": "Oral rehydration",
    "–î–∏–µ—Ç–∞ BRAT": "BRAT diet",
    "–ò–∑–±–µ–≥–∞—Ç—å –∂–∏—Ä–Ω–æ–π –ø–∏—â–∏": "Avoid fatty foods",
    # Questions
    "–ö–∞–∫–∞—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞?": "What is the highest temperature?",
    "–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –¥–µ—Ä–∂–∏—Ç—Å—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞?": "How many days does fever persist?",
    "–ï—Å—Ç—å –ª–∏ –æ–∑–Ω–æ–±?": "Any chills?",
    "–°—É—Ö–æ–π –∏–ª–∏ –≤–ª–∞–∂–Ω—ã–π –∫–∞—à–µ–ª—å?": "Dry or productive cough?",
    "–ï—Å—Ç—å –ª–∏ –æ–¥—ã—à–∫–∞?": "Any shortness of breath?",
    "–ï—Å—Ç—å –ª–∏ –∫—Ä–æ–≤—å –≤ –º–æ–∫—Ä–æ—Ç–µ?": "Any blood in sputum?",
    "–ï—Å—Ç—å –ª–∏ –Ω–∞–ª—ë—Ç –Ω–∞ –º–∏–Ω–¥–∞–ª–∏–Ω–∞—Ö?": "Any tonsillar exudate?",
    "–ï—Å—Ç—å –ª–∏ –≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞?": "High fever present?",
    "–ë–æ–ª—å –ø—É–ª—å—Å–∏—Ä—É—é—â–∞—è?": "Is the pain pulsating?",
    "–¢–æ—à–Ω–æ—Ç–∞/—Å–≤–µ—Ç–æ–±–æ—è–∑–Ω—å?": "Nausea/photophobia?",
    "–°–≤—è–∑—å —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π?": "Relation to exertion?",
    "–ò—Ä—Ä–∞–¥–∏–∞—Ü–∏—è –≤ —Ä—É–∫—É/—á–µ–ª—é—Å—Ç—å?": "Radiation to arm/jaw?",
    "–ü–æ—Ç–ª–∏–≤–æ—Å—Ç—å/—Ç–æ—à–Ω–æ—Ç–∞?": "Sweating/nausea?",
    "–°–≤–∏—Å—Ç—è—â–µ–µ –¥—ã—Ö–∞–Ω–∏–µ?": "Wheezing?",
    "–û—Ç—ë–∫–∏?": "Edema?",
    "–ë–æ–ª—å –≤ –≥—Ä—É–¥–∏?": "Chest pain?",
    "–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –±–æ–ª–∏?": "Pain location?",
    "–°–≤—è–∑—å —Å –ø—Ä–∏—ë–º–æ–º –ø–∏—â–∏?": "Relation to meals?",
    "–¢–æ—à–Ω–æ—Ç–∞/—Ä–≤–æ—Ç–∞/–¥–∏–∞—Ä–µ—è?": "Nausea/vomiting/diarrhea?",
    "–ó—É–¥?": "Itching?",
    "–ù–æ–≤—ã–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞/–∫–æ—Å–º–µ—Ç–∏–∫–∞?": "New meds/cosmetics?",
    "–ö—Ä–æ–≤—å –≤ —Å—Ç—É–ª–µ?": "Blood in stool?",
    "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞?": "Fever?",
    "–ù–µ–¥–∞–≤–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏?": "Recent travel?",
    "–°–≤—è–∑—å —Å –µ–¥–æ–π?": "Relation to food?",
    "–ë–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–∞?": "Possible pregnancy?",
    # Red flags
    "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > 39¬∞C –±–æ–ª–µ–µ 3 –¥–Ω–µ–π": ">39¬∞C for more than 3 days",
    "–°–∏–ª—å–Ω–∞—è –≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å –∏ —Ä–∏–≥–∏–¥–Ω–æ—Å—Ç—å —à–µ–∏": "Severe headache and neck stiffness",
    "–û–¥—ã—à–∫–∞": "Shortness of breath",
    "–ö—Ä–æ–≤–æ—Ö–∞—Ä–∫–∞–Ω–∏–µ": "Hemoptysis",
    "–ë–æ–ª—å –≤ –≥—Ä—É–¥–∏": "Chest pain",
    "–ó–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏–µ –¥—ã—Ö–∞–Ω–∏—è": "Breathing difficulty",
    "–°–∏–ª—å–Ω–æ–µ –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏–µ –≥–ª–æ—Ç–∞–Ω–∏—è": "Severe swallowing difficulty",
    "–í–Ω–µ–∑–∞–ø–Ω–∞—è —Å–∏–ª—å–Ω–µ–π—à–∞—è –±–æ–ª—å": "Sudden worst-ever pain",
    "–û—á–∞–≥–æ–≤—ã–π –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –¥–µ—Ñ–∏—Ü–∏—Ç": "Focal neurological deficit",
    "–î–∞–≤—è—â–∞—è –±–æ–ª—å –≤ –≥—Ä—É–¥–∏": "Pressing chest pain",
    "–•–æ–ª–æ–¥–Ω—ã–π –ø–æ—Ç": "Cold sweat",
    "–û–±–º–æ—Ä–æ–∫": "Syncope",
    "–û–¥—ã—à–∫–∞ –≤ –ø–æ–∫–æ–µ": "Dyspnea at rest",
    "–°–∞—Ç—É—Ä–∞—Ü–∏—è –Ω–∏–∑–∫–∞—è (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞)": "Low oxygen saturation (if known)",
    "–ñ–∏–≤–æ—Ç –Ω–∞–ø—Ä—è–∂—ë–Ω": "Rigid abdomen",
    "–ö—Ä–æ–≤—å –≤ —Å—Ç—É–ª–µ/—Ä–≤–æ—Ç–µ": "Blood in stool/vomit",
    "–í—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞": "High fever",
    "–û—Ç—ë–∫ –ª–∏—Ü–∞/—è–∑—ã–∫–∞": "Facial/tongue swelling",
}


def t(key: str, lang: str) -> str:
    return UI_TEXT.get(key, {}).get(lang, UI_TEXT.get(key, {}).get("en", key))


def translate_condition(name: str, lang: str) -> str:
    if lang == "ru":
        return name
    return CONDITION_RU_EN.get(name, name)


def translate_list(items: List[str], lang: str) -> List[str]:
    if lang == "ru":
        return items
    return [PHRASE_RU_EN.get(x, x) for x in items]


def localize_triage(tr: TriageResult, lang: str) -> Dict:
    return {
        "risk_level": RISK_MAP.get(lang, RISK_MAP["en"]).get(tr.risk_level, tr.risk_level),
        "possible_conditions": [
            {
                "condition": translate_condition(h.condition, lang),
                "confidence": h.confidence,
            }
            for h in tr.possible_conditions
        ],
        "self_care_advice": translate_list(tr.self_care_advice, lang),
        "doctor_questions": translate_list(tr.doctor_questions, lang),
    }


